\documentclass{minimal}
\usepackage{soul}
\usepackage{tokcycle}

\gdef\makebar{\rule[.8ex]{.8pt}{10.5pt}}

\begingroup
\catcode`\|=11
\catcode`\^^M=13
\catcode`G=13
\gdefG#1^^M{\parindent=0pt%
  \tokencycle%
  {\ifx-##1\rule[.8ex]{.8em}{.5pt}\else{\ifx |##1\makebar\else\makebox[.8em]{##1}\fi}\fi}%
  {}%
  {}%
  {\makebox[1em]{##1}}#1\endtokencycle%
  \newline}
\endgroup

% LESSON LEARNED: it is best to start the control sequence with the letter (G, G# etc.
% than trying to delimit it with | or -, because of ambiguity (| can appear multiple
% times, and - can be start and end of a sequence at once)
% also, if | is letter, then \ifx| is one command, there must be a space in between
\begin{document}
\begingroup
\catcode`\|=11
\catcode`\^^M=13
\catcode`G=13
G|-2-5h3-|--4-5---|
G|--1-23-|--4-5---|
\endgroup
\end{document}
