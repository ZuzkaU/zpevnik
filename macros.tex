\newcommand{\songTitle}[1]{
  {\Huge\sffamily\bfseries\MakeUppercase{#1}}
}

\newcommand{\songAuthor}[1]{
  {\LARGE\sffamily\slshape #1}
}

\newenvironment{song}[3]{
  \clearpage
  \centering
  \songTitle{#1}\\[8pt]
  \songAuthor{#2}\\[8pt]
  \begin{guitar}
  \leftskip=#3
  \Large
}{  
  \end{guitar}
}

\renewcommand{\verse}[1]{%
  \sbox{\mybox}{\LARGE\bfseries #1.}%
  \hskip -\wd\mybox%
  \hskip -5pt%
  \usebox{\mybox}%
  \hskip 5pt%
}


\newsavebox\mybox

\newcommand{\chorus}{%
  \sbox{\mybox}{\LARGE\bfseries R:}%
  \hskip -\wd\mybox%
  \hskip -5pt%
  \usebox{\mybox}%
  \hskip 5pt%
}

\renewcommand{\guitarPreAccord}{\sffamily\bfseries\Large}

\renewcommand\guitarEndLine{\par\leavevmode\setstretch{1}}
\renewcommand\guitarEndPar{\par\bigskip\leavevmode}

% Hack: set line spacing when there are chords and set how much the chords are raised
\def\setChordsLineStretch{\setstretch{1.75}}
\def\setRaiseHeigth{13pt}
\renewcommand\guitarPut[1]{\setChordsLineStretch\setbox0\hbox{\strut#1}\leavevmode
  \raise\setRaiseHeigth\hbox to 0pt{\hbox to\wd0{\guitarPreAccord
    \hfill\guitarAccord\hfill\hss}\hss}#1}
\renewcommand\guitarPutOnSpace{\setChordsLineStretch\leavevmode\raise\setRaiseHeigth
  \hbox{\guitarPreAccord\guitarAccord}}
\makeatletter
\renewcommand\gtr@distMerge[2]{\setChordsLineStretch\setbox\guitarBox\hbox{\strut#2}%
  \setbox0\hbox{\guitarPreAccord\guitarAccord}\leavevmode
  \guitarDim=\wd0\relax\guitarCalcDim
  \ifdim\wd\guitarBox<\guitarDim% Accord is too large:
    \hbox to 0pt{\raise\setRaiseHeigth\hbox{\copy0}\hss}%
    \hbox to\guitarDim{\box\guitarBox#1}%
    \let\guitarAccord\toolboxEmpty%now used as a temporary variable.
  \else
    \hbox to 0pt{\raise\setRaiseHeigth
      \hbox to\wd\guitarBox{\hfil\box0\hfil}\hss}%
    \def\guitarAccord{#2}%
  \fi\guitarAccord}
\makeatother

% Hack: makes \leftskip work in guitar environment
\renewcommand\guitarCrOnHook{\begingroup
  \parindent 0pt\leavevmode\nobreak\hskip-\leftskip\relax
  \finalhyphendemerits=0\everypar{\nobreak}\sloppy\relax
  \linepenalty=50\relax\parskip0pt\relax}

